<?xml version="1.0"?>
<test_scenario>
  <dictionary name="DICT_Sales_postgres.xml"/>

  <!-- Test loading from file-->
  <output_file name="MODEL_LOADING_result.html" descr="GdaDataModelArray loading test"/>
  <header descr="Loading file 'data_model_0.xml'"/>
  <action type="load_file" model="model0" file="data_model_0.xml" descr="Loading file"/>
  <action type="show_model" model="model0"/>

  
  <!-- Test adding and removing rows -->
  <output_file name="ARRAY_MODEL_result.html" descr="GdaDataModelArray adding and removing rows"/>
  <header descr="Loading file 'data_model_1.xml'"/>
  <action type="load_file" model="model1" file="data_model_1.xml" descr="Loading file"/>
  <action type="show_model" model="model1"/>

  <header descr="Appending 2 rows"/>
  <action type="append_data" model="model1">
    <gda_array_data>
      <gda_array_row>
	<gda_value>Value 1.1</gda_value>
	<gda_value>Value 1.2</gda_value>
      </gda_array_row>
      <gda_array_row>
	<gda_value>Value 2.1</gda_value>
	<gda_value>Value 2.1</gda_value>
      </gda_array_row>
    </gda_array_data>
  </action>
  <action type="show_model_data" model="model1"/>

  <header descr="Removing rows"/>
  <action type="remove_row" model="model1" row="10" descr="Removing row n.10" expect="f"/>
  <action type="remove_row" model="model1" row="1" descr="Removing row n.1"/>
  <action type="show_model_data" model="model1"/>
  <action type="remove_row" model="model1" row="1" descr="Removing row n.1"/>
  <action type="show_model_data" model="model1"/>

  <header descr="Updating rows"/>
  <action type="set_value" model="model1" row="1" col="1" descr="Change value at row,col = (1,1)">
    <gda_value>New value</gda_value>
  </action>
  <action type="show_model_data" model="model1"/>
  <action type="set_value" model="model1" row="1" col="2" descr="Change value at row,col = (1,2)" expect="f">
    <gda_value>New value</gda_value>
  </action>

  <!-- Test GdaDataProxy -->
  <output_file name="PROXY_MODEL_result.html" descr="GdaDataProxy testing"/>
  <header descr="Proxied model is the following"/>
  <action type="show_model" model="model0"/>
  <header descr="Proxy creation"/>
  <action type="create_proxy" model="model0_prox" proxied_model="model0"/>
  <action type="idle" wait_sec="1"/>
  <action type="show_model" model="model0_prox"/>

  <header descr="Updating rows"/>
  <action type="set_value" model="model0_prox" row="1" col="1" descr="Change value at row,col = (1,1)">
    <gda_value>New value</gda_value>
  </action>
  <action type="set_value" model="model0_prox" row="2" col="2" descr="Change value at row,col = (2,2)">
    <gda_value>234</gda_value>
  </action>
  <action type="set_value" model="model0_prox" row="0" col="2" descr="Change value at row,col = (0,2) to NULL">
    <gda_value isnull="t"/>
  </action>
  <action type="remove_row" model="model0_prox" row="3" descr="Removing row n.3" expect="t"/>
  <action type="show_model_data" model="model0_prox"/>
  <action type="show_model_data" model="model0"/>

  <header descr="Applying proxy changes"/>
  <action type="apply_proxy" model="model0_prox" descr="Applying proxy changes"/>
  <action type="show_model_data" model="model0_prox"/>
  <action type="show_model_data" model="model0"/>

  <header descr="Changing rows in the proxied model"/>
  <action type="set_value" model="model0" row="2" col="2" descr="Change value at row,col = (2,2)">
    <gda_value>111</gda_value>
  </action>
  <action type="show_model_data" model="model0_prox"/>
  <action type="remove_row" model="model0" row="0" descr="Removing row n.0" expect="t"/>
  <action type="show_model_data" model="model0_prox"/>
  <action type="append_data" model="model0" descr="Adding rows to the proxied model">
    <gda_array_data>
      <gda_array_row>
	<gda_value>1111</gda_value>
	<gda_value>A good name</gda_value>
	<gda_value isnull="t"/>
	<gda_value>SP</gda_value>
	<gda_value>MDR</gda_value>
      </gda_array_row>
      <gda_array_row>
	<gda_value>2222</gda_value>
	<gda_value>A bad name</gda_value>
	<gda_value isnull="t"/>
	<gda_value isnull="t"/>
	<gda_value isnull="t"/>
      </gda_array_row>
    </gda_array_data>
  </action>
  <action type="idle" wait_sec="1"/>
  <action type="show_model_data" model="model0_prox"/>
  

</test_scenario>
